 
Wednesday 06 November 2024 05:39:20 PM IST
 
!!-----------------------------------------------------
!! This program performs integration of functions using Simpson's 1/3rd Rule
!! Original Author: Raj Handique
!! Date Created: 06 November 2024
!! FORTRAN 95 Source Code
!!-----------------------------------------------------
program Simpson_Quarter_Integration

!!---------------------------------
!! This program will require the user to declare all the variables and typecast explicitly !!
!!---------------------------------
!! Declare the variables
!!---------------------------------
implicit none
integer::n, i, counter
real::func, diff
real::a, b, h, inc, true_integration_val
real::Integration

!!---------------------------------
!! Analysis Block
!!---------------------------------

	WRITE(*,*)"-------------------------------"
	WRITE(*,*)"Enter the initial no. of steps:"
	READ(*,*) n
	WRITE(*,*)"-------------------------------"
	WRITE(*,*)"Initial number of steps: ", n
	WRITE(*,*)"-------------------------------"

	WRITE(*,*)"-------------------------------"
	WRITE(*,*)"Enter the lower limit: "
	READ(*,*) a
	WRITE(*,*)"The lower limit is: ",a
	WRITE(*,*)"-------------------------------"
	WRITE(*,*)"Enter the upper limit: "
	READ(*,*) b
	WRITE(*,*)"The upper limit is: ",b
	WRITE(*,*)"-------------------------------"
	
	!! Simpsons's Rule
	
	WRITE(*,*)"--------------------------------------------------------------------------------------------------------------"
	WRITE(*,*)"|       n     |        h         |        h^4       |        I         |        I_n       |       Error      |"
	WRITE(*,*)"--------------------------------------------------------------------------------------------------------------"
	counter=1
	true_integration_val = 0.25
	DO 
		IF(counter>15) EXIT
		
		h = (b-a)/n	
		Integration = func(a) + func(b)
		
		DO i=1, (n-1)
			inc = a + (i*h)	
			!! For even terms
			IF(MOD(i,2)==0) THEN
				Integration = Integration + (2.0*func(inc))	
			!! For odd terms
			ELSE
				Integration = Integration + (4.0*func(inc))
			ENDIF
		ENDDO	
		Integration = (h/3.0)*Integration
		diff = ABS(true_integration_val - Integration)
		
		WRITE(*,*)"|",n,"|",h,"|",h**4,"|",true_integration_val,"|",Integration,"|",diff,"|"
		
		n = n+10
		counter=counter+1
	ENDDO
	WRITE(*,*)"--------------------------------------------------------------------------------------------------------------"
	WRITE(*,10)"The value of integration of given function is:", Integration
	WRITE(*,*)"--------------------------------------------------------------------------------------------------------------"
	
	10 FORMAT(1A, F15.8)

end program Simpson_Quarter_Integration

!!---------------------------------
!! function sub-programs
!!---------------------------------

real function func(x)
	implicit none
	real::x
	func = x**3
	return
end function func


Output***********************************
 -------------------------------
 Enter the initial no. of steps:
 -------------------------------
 Initial number of steps:           10
 -------------------------------
 -------------------------------
 Enter the lower limit: 
 The lower limit is:    0.00000000    
 -------------------------------
 Enter the upper limit: 
 The upper limit is:    1.00000000    
 -------------------------------
 --------------------------------------------------------------------------------------------------------------
 |       n     |        h         |        h^4       |        I         |        I_n       |       Error      |
 --------------------------------------------------------------------------------------------------------------
 |          10 |  0.100000001     |   1.00000012E-04 |  0.250000000     |  0.250000030     |   2.98023224E-08 |
 |          20 |   5.00000007E-02 |   6.25000075E-06 |  0.250000000     |  0.250000030     |   2.98023224E-08 |
 |          30 |   3.33333351E-02 |   1.23456823E-06 |  0.250000000     |  0.250000060     |   5.96046448E-08 |
 |          40 |   2.50000004E-02 |   3.90625047E-07 |  0.250000000     |  0.250000030     |   2.98023224E-08 |
 |          50 |   1.99999996E-02 |   1.59999985E-07 |  0.250000000     |  0.249999940     |   5.96046448E-08 |
 |          60 |   1.66666675E-02 |   7.71605144E-08 |  0.250000000     |  0.250000030     |   2.98023224E-08 |
 |          70 |   1.42857144E-02 |   4.16493116E-08 |  0.250000000     |  0.250000030     |   2.98023224E-08 |
 |          80 |   1.25000002E-02 |   2.44140654E-08 |  0.250000000     |  0.250000000     |   0.00000000     |
 |          90 |   1.11111114E-02 |   1.52415787E-08 |  0.250000000     |  0.250000000     |   0.00000000     |
 |         100 |   9.99999978E-03 |   9.99999905E-09 |  0.250000000     |  0.249999970     |   2.98023224E-08 |
 |         110 |   9.09090880E-03 |   6.83013290E-09 |  0.250000000     |  0.249999985     |   1.49011612E-08 |
 |         120 |   8.33333377E-03 |   4.82253215E-09 |  0.250000000     |  0.250000060     |   5.96046448E-08 |
 |         130 |   7.69230770E-03 |   3.50127793E-09 |  0.250000000     |  0.249999970     |   2.98023224E-08 |
 |         140 |   7.14285718E-03 |   2.60308197E-09 |  0.250000000     |  0.250000000     |   0.00000000     |
 |         150 |   6.66666683E-03 |   1.97530858E-09 |  0.250000000     |  0.250000000     |   0.00000000     |
 --------------------------------------------------------------------------------------------------------------
The value of integration of given function is:     0.25000000
 --------------------------------------------------------------------------------------------------------------

*****************************************
